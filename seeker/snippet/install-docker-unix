#date: 2023-06-30T17:07:40Z
#url: https://api.github.com/gists/6498d66cd446f5818ad9226c155be852
#owner: https://api.github.com/users/gajendra121102

#!/bin/bash
echo "Checking if docker is installed..."
status=$(systemctl is-active docker.service)
if [ $status == "active" ]; then
echo "Docker is running, stopping and removing it..."
    sudo systemctl stop docker.service
    sudo systemctl stop docker.socket
    sudo apt-get remove -y docker docker-engine docker.io containerd runc
echo "Docker has been stopped and removed."
else
echo "Docker is not running or not installed."
fi
echo "Updating apt package manager..."
sudo apt-get update -y
echo "Adding Docker's official GPG key..."
sudo mkdir -p /etc/apt/keyrings
sudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg --yes
echo "Adding Docker's official repository to apt sources..."
sudo echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
echo "Updating apt package list..."
sudo apt-get update -y
echo "Installing Docker..."
sudo apt-get install -y docker-ce docker-ce-cli containerd.io docker-compose-plugin -y
sudo apt-get autoremove -y
sudo apt-get clean
echo "Adding current user to the Docker group..."
sudo usermod -aG docker $USER
echo "Starting Docker service..."
sudo systemctl start docker.service
sudo systemctl start docker.socket
sudo systemctl enable docker.service
sudo systemctl enable docker.socket