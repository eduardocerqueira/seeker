#date: 2023-04-05T17:10:32Z
#url: https://api.github.com/gists/f0968d135ad2b2336e1fbb5e213143c2
#owner: https://api.github.com/users/Slebluue

#!/bin/bash

# pr_search will conduct a search of pull requests to Github
#
# You will need a GH_TOKEN set in your path, it will need read access to reviewtrackers repositories
#
# Args:
# Search query - this is a generic search query like you put into your browser.
# This allows the script to search for anything without too much work on my part (having written the script)
# Hint: if it works in the browser it will work for this script
#
# Output:
# repository issue_number
#
# output is separated line by line, the format of this output is intentional so it can be pipped into pr_info
# 
# Example usage: pr_script q=author:slebluue 2023-01-01 2023-03-31

prs=$(curl -s -H "Authorization: "**********"://api.github.com/search/issues?'$1'%20state:closed%20merged:'$2'..'$3'&per_page=100')

echo $prs | jq '.items[] | "\(.repository_url) \(.number) "' | sed 's/https:\/\/api.github.com\/repos\/reviewtrackers\///' | sed 's/"//g'ed 's/"//g'