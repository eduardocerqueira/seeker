#date: 2023-10-24T16:56:55Z
#url: https://api.github.com/gists/b1cc2299768b7947168c8fe351a09d0c
#owner: https://api.github.com/users/ryanarj

from selenium import webdriver
from selenium.webdriver.common.by import By
from time import sleep
from selenium.webdriver.common.keys import Keys
import pyperclip
import pandas as pd


def main():
    google_subs_without_tokens = "**********"

 "**********"  "**********"  "**********"  "**********"  "**********"w "**********"i "**********"t "**********"h "**********"  "**********"o "**********"p "**********"e "**********"n "**********"( "**********"' "**********"G "**********"o "**********"o "**********"g "**********"l "**********"e "**********"S "**********"u "**********"b "**********"s "**********"c "**********"r "**********"i "**********"p "**********"t "**********"i "**********"o "**********"n "**********"s "**********"W "**********"i "**********"t "**********"h "**********"o "**********"u "**********"t "**********"T "**********"o "**********"k "**********"e "**********"n "**********". "**********"c "**********"s "**********"v "**********"' "**********", "**********"  "**********"' "**********"r "**********"' "**********") "**********"  "**********"a "**********"s "**********"  "**********"f "**********"i "**********"l "**********"e "**********": "**********"
        df = pd.read_csv(file)
        for index, row in df.iterrows():
 "**********"  "**********"  "**********"  "**********"  "**********"  "**********"  "**********"  "**********"  "**********"  "**********"  "**********"  "**********"  "**********"i "**********"f "**********"  "**********"p "**********"d "**********". "**********"i "**********"s "**********"n "**********"a "**********"( "**********"r "**********"o "**********"w "**********"[ "**********"' "**********"T "**********"o "**********"k "**********"e "**********"n "**********"' "**********"] "**********") "**********": "**********"
                google_subs_without_tokens[row['Reference Number']] = "**********"

    browser = webdriver.Chrome()
    browser.get('https://play.google.com/console/u/0/developers/5283287893883428767/orders')
    sleep(5)

    # Put a breakpoint on the next line, here and log into the dev console
    sleep(4)

    try:
 "**********"  "**********"  "**********"  "**********"  "**********"  "**********"  "**********"  "**********"  "**********"f "**********"o "**********"r "**********"  "**********"r "**********"e "**********"f "**********"_ "**********"n "**********"u "**********"m "**********"b "**********"e "**********"r "**********"  "**********"i "**********"n "**********"  "**********"g "**********"o "**********"o "**********"g "**********"l "**********"e "**********"_ "**********"s "**********"u "**********"b "**********"s "**********"_ "**********"w "**********"i "**********"t "**********"h "**********"o "**********"u "**********"t "**********"_ "**********"t "**********"o "**********"k "**********"e "**********"n "**********"s "**********": "**********"
 "**********"  "**********"  "**********"  "**********"  "**********"  "**********"  "**********"  "**********"  "**********"  "**********"  "**********"  "**********"  "**********"i "**********"f "**********"  "**********"g "**********"o "**********"o "**********"g "**********"l "**********"e "**********"_ "**********"s "**********"u "**********"b "**********"s "**********"_ "**********"w "**********"i "**********"t "**********"h "**********"o "**********"u "**********"t "**********"_ "**********"t "**********"o "**********"k "**********"e "**********"n "**********"s "**********"[ "**********"r "**********"e "**********"f "**********"_ "**********"n "**********"u "**********"m "**********"b "**********"e "**********"r "**********"] "**********"  "**********"i "**********"s "**********"  "**********"N "**********"o "**********"n "**********"e "**********": "**********"
                order_search_bar = browser.find_element(
                    By.XPATH,
                    '//*[@id="main-content"]/div/div[1]/page-router-outlet/page-wrapper/div/orders-list-page/'
                    'orders-filter/console-block-2-columns/div[1]/div/console-search-input/div/material-input/'
                    'label/input'
                )
                order_search_bar.click()
                order_search_bar.send_keys(ref_number)
                sleep(1)
                order_search_bar.send_keys(Keys.RETURN)
                sleep(3)
                order_details_button = browser.find_element(
                    By.XPATH,
                    '//*[@id="main-content"]/div/div[1]/page-router-outlet/page-wrapper/div/orders-list-page'
                    '/console-block-1-column/div/div/console-table/div/div/ess-table/ess-particle-table/div[1]/div'
                    '/div[2]/div[2]/ess-cell[7]/console-table-main-action-cell/a/material-button[2]/button/div[2]'
                    '/material-icon/i'
                )
                order_details_button.click()
                sleep(5)
                copy_purchase_button = browser.find_element(
                    By.XPATH,
                    '//*[@id="main-content"]/div/div[1]/page-router-outlet/page-wrapper/div/order-details-page'
                    '/order-summary/console-block-1-column/div/div/console-button-set/div[2]/overflowable-item[2]'
                    '/button/span'
                )

                copy_purchase_button.click()
                sleep(3)
                google_subs_without_tokens[ref_number] = "**********"

                order_management_button = browser.find_element(
                    By.XPATH,
                    '//*[@id="console-root-021280"]/console-chrome/div/material-drawer[2]/navigation-bar/nav/div/div[5]'
                    '/navigation-subtree/div/navigation-element/a/div/material-ripple'
                )
                order_management_button.click()
            sleep(3)
        save_csv_file(google_subs_without_tokens)
    except Exception as e:
        save_csv_file(google_subs_without_tokens)
        pass


 "**********"d "**********"e "**********"f "**********"  "**********"s "**********"a "**********"v "**********"e "**********"_ "**********"c "**********"s "**********"v "**********"_ "**********"f "**********"i "**********"l "**********"e "**********"( "**********"g "**********"o "**********"o "**********"g "**********"l "**********"e "**********"_ "**********"s "**********"u "**********"b "**********"s "**********"_ "**********"w "**********"i "**********"t "**********"h "**********"o "**********"u "**********"t "**********"_ "**********"t "**********"o "**********"k "**********"e "**********"n "**********"s "**********", "**********"  "**********"f "**********"i "**********"l "**********"e "**********"n "**********"a "**********"m "**********"e "**********"= "**********"' "**********"G "**********"o "**********"o "**********"g "**********"l "**********"e "**********"S "**********"u "**********"b "**********"s "**********"c "**********"r "**********"i "**********"p "**********"t "**********"i "**********"o "**********"n "**********"s "**********"W "**********"i "**********"t "**********"h "**********"o "**********"u "**********"t "**********"T "**********"o "**********"k "**********"e "**********"n "**********". "**********"c "**********"s "**********"v "**********"' "**********") "**********": "**********"

    # writing to csv file
    with open(filename, 'r') as file:
        google_df = pd.read_csv(file)

    for index, row in google_df.iterrows():
 "**********"  "**********"  "**********"  "**********"  "**********"  "**********"  "**********"  "**********"  "**********"i "**********"f "**********"  "**********"g "**********"o "**********"o "**********"g "**********"l "**********"e "**********"_ "**********"s "**********"u "**********"b "**********"s "**********"_ "**********"w "**********"i "**********"t "**********"h "**********"o "**********"u "**********"t "**********"_ "**********"t "**********"o "**********"k "**********"e "**********"n "**********"s "**********". "**********"g "**********"e "**********"t "**********"( "**********"r "**********"o "**********"w "**********"[ "**********"' "**********"R "**********"e "**********"f "**********"e "**********"r "**********"e "**********"n "**********"c "**********"e "**********"  "**********"N "**********"u "**********"m "**********"b "**********"e "**********"r "**********"' "**********"] "**********") "**********": "**********"
            google_df.loc[index, 'Token'] = "**********"
    google_df.to_csv(filename)


if __name__ == '__main__':
    main()
