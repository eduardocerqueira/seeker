#date: 2023-03-29T17:52:27Z
#url: https://api.github.com/gists/68026864d502473eacd56b2e16e40108
#owner: https://api.github.com/users/senko

#!/bin/bash

if test -z "$1"; then
    echo "Usage: $0 <prompt>"
    exit 1
fi

if test -z "$OPENAI_API_KEY"; then
    echo "OpenAI key is missing - \$OPENAI_API_KEY must be set"
    exit 1
fi

prompt="$*"

curl https://api.openai.com/v1/chat/completions -s \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $OPENAI_API_KEY" \
  -d "{\"model\": \"gpt-3.5-turbo\", \"messages\": [{\"role\": \"user\", \"content\": \"$prompt\"}], \"temperature\": 0.7 }" \
  | jq -r '.choices[0].message.content'
