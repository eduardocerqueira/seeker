#date: 2022-03-10T17:13:24Z
#url: https://api.github.com/gists/ded280c328fad9745c4910650f8c4ac9
#owner: https://api.github.com/users/macaron

#!/bin/sh

%# family=auto
%# capabilities=autoconf

# https://github.com/itzg/mc-monitor
NUM_OF_PLAYERS=/usr/local/bin/mc-monitor status-bedrock --host localhost | cut -d' ' -f4 | sed -e 's/online=//g'

if [ "$1" = "autoconfig" ]; then
  if [ -n ${NUM_OF_PLAYERS} ]; then
    echo yes
    exit 0
  else
    echo mc-monitor command not found. https://github.com/itzg/mc-monitor
    exit 1
  fi
fi

if [ "$1" = "config" ]; then
  echo 'graph_title Players'
  echo 'graph_args --rigid --lower-limit 0 --upper-limit 20'
  echo 'graph_scale no'
  echo 'graph_vlabel Players'
  echo 'graph_category Minecraft'
  echo 'players.label Players'
  echo 'players.min 0'
  echo 'players.max 20'
  echo 'players.draw AREA'
  echo 'players.type GAUGE'
  exit 0
fi

echo "players.value $NUM_OF_PLAYERS"