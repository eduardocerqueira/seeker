#date: 2024-03-15T16:59:56Z
#url: https://api.github.com/gists/21ff273f794616e425d2040d102f9923
#owner: https://api.github.com/users/k4lizen

from pwn import *

def start():
    if args.GDB:
        return gdb.debug([ld.path, elff.path], gdbinit, aslr=using_aslr, env={"LD_PRELOAD": libc.path})
    elif args.REMOTE:
        return remote(sys.argv[1], sys.argv[2])
    return process([ld.path, elff.path], aslr=using_aslr, env={"LD_PRELOAD": libc.path})

gdbinit = '''
init-pwndbg
break main
'''
using_aslr = False
elff = context.binary = ELF('./vuln', checksec=False)
libc = ELF('./libc.so.6', checksec=False)
ld = ELF('./ld-linux.so', checksec=False)
context.log_level = 'debug'
context.terminal = ['tmux', 'split', '-h', '-l', '65%', '-b']

p = start()

p.interactive()
p.close()