#date: 2024-06-18T17:04:20Z
#url: https://api.github.com/gists/80c055907615f9c5f9128276ba50ab3f
#owner: https://api.github.com/users/jchai01

#!/bin/sh

# Description:
# looks for .venv in the current directory. If found, activate the virtual environment. Otherwise, ask to create with the current python version.
#
# Usage:
# store this script anywhere in your file system, named the file ve.
# enable it to be executed anywhere: sudo ln -sf $(pwd)/ve /usr/local/bin
# run the script with '. ve' instead of 've' in order to activate virtual environment. 
# change python version with pyenv (for e.g. pyenv global 3.8).

env_name=${1:-".venv"}
pyv="$(python -V 2>&1)"

if [ -d "$env_name" ]; then
    echo "Virtual environment '$env_name' exists. Activating..."
    source "./$env_name/bin/activate"
    return 0
else
    echo "No virtual environment, create with $pyv?(y/n)"
    while true; do
        read -s -n 1 key
        case $key in
            y|Y)
                echo "Creating virtual environment..."
                python3 -m venv "$env_name"
                source "./$env_name/bin/activate"
                exit 0
                ;;
            n|N)
                echo "Operation canceled."
                exit 0
                ;;
            *)
                echo "Invalid input. Please press 'y' or 'n'."
                ;;
        esac
    done
fi